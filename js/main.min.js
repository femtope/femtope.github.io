function adjustLayerbyZoom(e){if(e>8){if(!GINAdmin2){map.addLayer(guineaAdminLayer2);for(var o=0;o<GINLabels.length;o++)GINLabels[o].addTo(map);GINAdmin2=!0}}else{map.removeLayer(guineaAdminLayer2);for(var o=0;o<GINLabels.length;o++)map.removeLayer(GINLabels[o]);GINAdmin2=!1}}function triggerUiUpdate(){type=$("#hf_type").val(),region=$("#region_scope").val(),prefecture=$("#prefecture_scope").val();var e=buildQuery(type,region,prefecture,sub_prefecture);getData(e),prefecture_select=$("#region_scope").val()}function buildQuery(e,o,r,t){var a=!1;return query="https://femtope.cartodb.com/api/v2/sql?format=GeoJSON&q=SELECT * FROM guinea_hf",e.length>0||o.length>0||r.length>0||t.length>0?(query=query.concat(" WHERE"),e.length>0&&(query=query.concat(" type = '".concat(e.concat("'"))),a=!0),o.length>0&&(query=query.concat(a?" AND region = '".concat(o.concat("'")):" region = '".concat(o.concat("'"))),a=!0),r.length>0&&(query=query.concat(a?" AND prefecture = '".concat(r.concat("'")):" prefecture = '".concat(r.concat("'"))),a=!0),t.length>0&&(query=query.concat(a?" AND sub_prefecture = '".concat(t.concat("'")):" sub_prefecture = '".concat(t.concat("'"))),a=!0)):query="http://femtope.cartodb.com/api/v2/sql?format=GeoJSON&q=SELECT * FROM guinea_hf",query}function addDataToMap(e){null!=dataLayer&&map.removeLayer(dataLayer),null!=markerGroup&&map.removeLayer(markerGroup);var o=L.icon({iconUrl:"image/Hospital_Logo_01.png",iconSize:[20,20],iconAnchor:[25,25]});$("#projectCount").text(e.features.length),markerGroup=L.markerClusterGroup({showCoverageOnHover:!1,zoomToBoundsOnClick:!0,removeOutsideVisibleBounds:!0}),dataLayer=L.geoJson(e,{pointToLayer:function(e,r){var t=L.marker(r,{icon:o});return t},onEachFeature:function(e,o){e.properties&&e.properties.cartodb_id&&o.on("click",function(){displayInfo(e)})}}),markerGroup.addLayer(dataLayer),map.addLayer(markerGroup)}function addAdminLayersToMap(e){var o={admin0:{clickable:!0,color:"#B81609",fillColor:"#ffffff",weight:2,opacity:1.5,fillOpacity:.1},admin2:{clickable:!0,color:"#412406",fillColor:"#80FFFFFF",weight:1.5,opacity:.5,fillOpacity:.1},region:{clickable:!0,color:"#e2095c",fillColor:"#80FFFFFF",weight:2,opacity:.7,fillOpacity:.1},prefecture:{clickable:!0,color:"#e2095c",fillColor:"#80FFFFFF",weight:2.5,opacity:.7,fillOpacity:.1},sub_prefecture:{clickable:!0,color:"#ff0000",fillColor:"#80FFFFFF",weight:2.5,opacity:.7,fillOpacity:.1}};regionSelect=$("#region_scope").val(),prefectureSelect=$("#prefecture_scope").val(),guineaAdminLayer0=L.geoJson(e.guineaAdmin0,{style:o.admin0}).addTo(map),guineaAdminLayer2=L.geoJson(e.guineaAdmin2,{style:o.region,onEachFeature:function(e,o){var r=L.divIcon({className:"labelLga-icon",html:e.properties.NAME_2});GINLabels.push(L.marker(o.getBounds().getCenter(),{icon:r}))}}),null!=region_layer&&map.removeLayer(region_layer),region_layer=L.geoJson(e.guineaAdmin1,{filter:function(e){return e.properties.NAME_1===regionSelect},style:o.region}).addTo(map),map.fitBounds(region_layer.getBounds()),null!=prefecture_layer&&map.removeLayer(prefecture_layer),prefecture_layer=L.geoJson(e.guineaAdmin2,{filter:function(e){return e.properties.NAME_2===prefectureSelect},style:o.region}).addTo(map),map.fitBounds(prefecture_layer.getBounds())}function displayInfo(e){var o=buildPopupContent(e);$("#infoContent").html(o)}function normalizeName(e){return e=e.replace("_"," ").replace("of_"," of "),e=e.replace(/\w\S*/g,function(e){return e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()})}function buildPopupContent(e){for(var o="",r=["country","region","prefecture","sub_prefecture","place","type","organization","center"],t=0;t<r.length;t++)o=o.concat("<p><strong>"+normalizeName(r[t])+": </strong>"+e.properties[r[t]]+"</p>");return o}function showLoader(){$(".fa-spinner").addClass("fa-spin"),$(".fa-spinner").show()}function hideLoader(){$(".fa-spinner").removeClass("fa-spin"),$(".fa-spinner").hide()}function getData(e){showLoader(),$.post(e,function(e){hideLoader(),addDataToMap(e),console.log("Data-Geo::  ",e)}).fail(function(){console.log("error!")})}function getAdminLayers(){showLoader();var e={};$.get("resources/GIN_Admin0.json",function(o){e.guineaAdmin0=o,addAdminLayersToMap(e)}).fail(function(){logError(null)}),$.get("resources/GIN_Admin1.json",function(o){e.guineaAdmin1=o,addAdminLayersToMap(e)}).fail(function(){logError(null)}),$.get("resources/GIN_Admin2.json",function(o){e.guineaAdmin2=o,addAdminLayersToMap(e)}).fail(function(){logError(null)})}function logError(){console.log("error!")}function geoLocate(e){function o(o){var r=o.coords;current_lat=r.latitude,current_long=r.longitude,current_accuracy=r.accuracy;var t={type:"FeatureCollection",features:[{type:"Feature",properties:{id:5},geometry:{type:"Point",coordinates:[current_long,current_lat]}}]},a=(L.geoJson(t).addTo(map),t.features[0].geometry.coordinates);lalo=L.GeoJSON.coordsToLatLng(a),map.setView(lalo,14);var n=1*e;buffered=turf.buffer(t,n,"kilometers"),bufferLayer=L.geoJson(buffered).addTo(map),bufferLayer.setStyle({stroke:!1,strokeWidth:2,fillColor:"red",fillOpacity:.1})}function r(e){console.warn("ERROR("+e.code+"): "+e.message)}var t={enableHighAccuracy:!0,timeout:1/0,maximumAge:0};navigator.geolocation.getCurrentPosition(o,r,t)}function radio_drive(){document.getElementById("2km").checked&&(null!=bufferLayer&&map.removeLayer(bufferLayer),twokm=$("#2km").val(),geoLocate(twokm)),document.getElementById("3km").checked&&(null!=bufferLayer&&map.removeLayer(bufferLayer),threekm=$("#3km").val(),geoLocate(threekm)),document.getElementById("4km").checked&&(null!=bufferLayer&&map.removeLayer(bufferLayer),fourkm=$("#4km").val(),geoLocate(fourkm))}function showPrefecture(){prefecture_show=document.getElementById("prefecture_id"),prefecture_show1=document.getElementById("prefecture_id1"),""!=prefecture_select?(prefecture_show.style.visibility="visible",prefecture_show1.style.visibility="visible"):(prefecture_show.style.visibility="hidden",prefecture_show1.style.visibility="hidden")}var type="",distance,twokm,threekm,fourkm,region="",prefecture="",prefecture_select="",sub_prefecture="",current_lat="",current_long="",current_accuracy="",positionOpt={},geoData=null,dataLayer=null,markerGroup=null,guineaAdminLayer0,guineaAdminLayer1,guineaAdminLayer2,region_layer=null,prefecture_layer=null,sub_prefecture_layer=null,bufferLayer=null,GINLabels=[],within,within_fc,buffered=null,GINAdmin2=!1,googleSat=L.tileLayer("http://{s}.google.com/vt/lyrs=s&x={x}&y={y}&z={z}",{maxZoom:20,subdomains:["mt0","mt1","mt2","mt3"]}),googleStreets=L.tileLayer("http://{s}.google.com/vt/lyrs=m&x={x}&y={y}&z={z}",{maxZoom:20,subdomains:["mt0","mt1","mt2","mt3"]}),terrain=googleTerrain=L.tileLayer("http://{s}.google.com/vt/lyrs=p&x={x}&y={y}&z={z}",{maxZoom:20,subdomains:["mt0","mt1","mt2","mt3"]}),osm=L.tileLayer("http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{maxZoom:18}),mapbox=L.tileLayer("https://maps.nlp.nokia.com/maptiler/v2/maptile/newest/normal.day.grey/{z}/{x}/{y}/256/png8?lg=eng&token=61YWYROufLu_f8ylE0vn0Q&app_id=qIWDkliFCtLntLma2e6O",{maxZoom:18}),map=L.map("map",{center:[9.6,-12.6],zoom:7,animation:!0,zoomControl:!1,layers:[mapbox]}),baseMaps={"Google Satelite":googleSat,"Google Street":googleStreets,Terrain:terrain,MapBox:mapbox,OSM:osm};map.on("zoomend",function(){adjustLayerbyZoom(map.getZoom())}),new L.Control.Zoom({position:"topright"}).addTo(map),L.control.layers(baseMaps).addTo(map),L.control.scale({position:"bottomright",maxWidth:100,metric:!0,updateWhenIdle:!0}).addTo(map),$(document).ready(function(){var e=$("#prefecture_scope option");$("#region_scope").change(function(){$("#prefecture_scope option").remove();var o=$("#region_scope option:selected").prop("class"),r=e.filter("."+o);$.each(r,function(e,o){$(o).appendTo("#prefecture_scope")})})}),getAdminLayers(),hideLoader();
//# sourceMappingURL=main.min.js.map
